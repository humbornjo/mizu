version: v2
clean: false

managed:
  enabled: true

  override:
    - file_option: go_package_prefix
      value: mizu.example/protogen

  disable:
    - module: buf.build/bufbuild/protovalidate
      file_option: go_package
    - module: buf.build/googleapis/googleapis
      file_option: go_package_prefix

plugins:
  - remote: buf.build/connectrpc/go:v1.18.1
    out: dist
    opt:
      - paths=source_relative

  - remote: buf.build/grpc/go:v1.6.1
    out: dist
    opt:
      - paths=source_relative

  - remote: buf.build/grpc-ecosystem/gateway:v2.27.7
    out: dist
    opt:
      - paths=source_relative

  - remote: buf.build/protocolbuffers/go:v1.36.6
    out: dist
    opt:
      - paths=source_relative

  # https://github.com/sudorandom/protoc-gen-connect-openapi
  - remote: buf.build/community/sudorandom-connect-openapi:v0.21.3
    out: dist
    opt:
      - path=openapi.yaml
      - trim-unused-types
      - with-proto-names
      - with-proto-annotations
